
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Python Active Directory Tools’s Documentation &#8212; Python Active Directory Tools 0.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Active Directory Basics" href="pyad.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pyad.html" title="Active Directory Basics"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Python Active Directory Tools 0.6 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python Active Directory Tools’s Documentation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="python-active-directory-tools-s-documentation">
<h1>Python Active Directory Tools’s Documentation<a class="headerlink" href="#python-active-directory-tools-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound" id="contents">
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyad.html">Active Directory Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyad.html#connecting-to-active-directory">Connecting to Active Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyad.html#basic-object-manipulation">Basic Object Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyad.html#creating-moving-and-deleting-objects">Creating, Moving, and Deleting Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyad.html#searching-active-directory">Searching Active Directory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">Manipulating Active Directory Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="objects.html#adobject">ADObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html#aduser">ADUser</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html#adcomputer">ADComputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html#adgroup">ADGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html#adcontainer">ADContainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html#addomain">ADDomain</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>pyad is a Python library designed to provide a simple, Pythonic interface to Active Directory
through ADSI on the Windows platform. Complete documentation can be found at
<a class="reference external" href="http://zakird.github.io/pyad/">http://zakird.github.io/pyad/</a>. Code is maintained at <a class="reference external" href="https://github.com/jcarswell/pyad">https://github.com/jcarswell/pyad</a>. The
library can be downloaded from PyPI at <a class="reference external" href="https://github.com/jcarswell/pyad">https://github.com/jcarswell/pyad</a>.</p>
</section>
<section id="breaking-changes-from-upstream">
<h1>Breaking Changes from upstream<a class="headerlink" href="#breaking-changes-from-upstream" title="Permalink to this headline">¶</a></h1>
<p>ADObject:</p>
<ul class="simple">
<li><p>_get_password_last_set - Act’s like AD and returns 1970-01-01 if the date can’t be parsed</p></li>
<li><p>get_last_login - Act’s like AD and returns 1970-01-01 if the date can’t be parsed</p></li>
</ul>
<p>Importing pyad directly exposes set_defaults, ADQuery, ADComputer, ADContainer, ADDomain,
ADGroup, ADUser, from_cn, from_dn, from_guid. Importing pyad.pyad no longer imports
the sub modules</p>
<p>Most ADObject update methods now take flush as an optional argument that defaults to True
to maintain compatibility with upstream code. For large updates it’s recommended to set
this to False until you are ready to write out the change, otherwise you may run into a
back-off period in AD where all further changes will fail.</p>
</section>
<section id="requirements">
<h1>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h1>
<p>pyad requires pywin32, available at <a class="reference external" href="https://github.com/mhammond/pywin32">https://github.com/mhammond/pywin32</a>.</p>
<p>Alternatively,</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line-block">
<div class="line">pip install pywin32</div>
<div class="line"><br /></div>
</div>
</div>
<p>works as well.</p>
</section>
<section id="connecting-to-active-directory">
<h1>Connecting to Active Directory<a class="headerlink" href="#connecting-to-active-directory" title="Permalink to this headline">¶</a></h1>
<dl class="simple">
<dt>By default, pyad will connect to the Active Directory domain to which the machine is</dt><dd><p>joined (rootDSE):</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyad</span> <span class="kn">import</span> <span class="n">ADUser</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;myuser&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to pass in options when connecting to a specific object. This will not
set the library defaults, but these settings will be used from any objects you derive from
it (e.g. if you request group membership of a user) Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
</pre></div>
</div>
<blockquote>
<div><p>from pyad import ADUser
user = ADUser.from_cn(“myuser”, options=dict(ldap_server=”dc1.domain.com”))</p>
</div></blockquote>
</section>
<section id="basic-object-manipulation">
<h1>Basic Object Manipulation<a class="headerlink" href="#basic-object-manipulation" title="Permalink to this headline">¶</a></h1>
<p>There are first order Python classes for different types of objects in Active Directory. For
example, ADUser represents user objects and ADGroup represents groups. All objects subclass
ADObject. Most methods are defined in ADObject, but subclasses generally provide additional
helper methods (e.g. ADUser has <cite>set_password</cite> and ADGroup has <cite>add_member</cite>).</p>
<p>It is possible to connect to an object by distinguished name, CN, UPN, and GUID if you already
know the type of object. Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyad</span> <span class="kn">import</span> <span class="n">ADUser</span>
<span class="n">user1</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_dn</span><span class="p">(</span><span class="s2">&quot;cn=myuser, ou=staff, dc=domain, dc=com&quot;</span><span class="p">)</span>
<span class="n">user2</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;myuser&quot;</span><span class="p">)</span>
<span class="n">user3</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_guid</span><span class="p">(</span><span class="s2">&quot;XXX-XXX-XXX&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to use the pyad factory with an arbitrary Active Directory object and
to receive an appropriately classed Python object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyad</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">pyad</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;user1&quot;</span><span class="p">)</span>
<span class="n">computer</span> <span class="o">=</span> <span class="n">pyad</span><span class="o">.</span><span class="n">from_dn</span><span class="p">(</span><span class="s2">&quot;cn=WS1,ou=Workstations,dc=domain,dc=com&quot;</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">pyad</span><span class="o">.</span><span class="n">from_guid</span><span class="p">(</span><span class="s2">&quot;XXX-XXX-XXX&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Unlike the ADSI interface, pyad objects are intended to interact with
one another. Instead of adding the DN of a user to the members attribute
of a group to add the user, you instead add the user object to the group.
For instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user1</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;myuser1&quot;</span><span class="p">)</span>
<span class="n">user2</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;myuser2&quot;</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">ADGroup</span><span class="o">.</span><span class="n">from_dn</span><span class="p">(</span><span class="s2">&quot;staff&quot;</span><span class="p">)</span>

<span class="n">group</span><span class="o">.</span><span class="n">add_members</span><span class="p">([</span><span class="n">user1</span><span class="p">,</span> <span class="n">user2</span><span class="p">])</span>

<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">get_members</span><span class="p">():</span>
    <span class="nb">print</span> <span class="n">user1</span><span class="o">.</span><span class="n">description</span>
</pre></div>
</div>
<p>However, it is still possible to directly manipulate any attribute outside of the helper
methods that pyad provides:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user1</span> <span class="o">=</span> <span class="n">ADUser</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;myuser1&quot;</span><span class="p">)</span>
<span class="n">user</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;new description&quot;</span><span class="p">)</span>
<span class="n">user</span><span class="o">.</span><span class="n">append_to_attribute</span><span class="p">(</span><span class="s2">&quot;member&quot;</span><span class="p">,</span> <span class="s2">&quot;cn=myuser1, ou=staff, dc=domain, dc=com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>More details on how to manipulate the objects you find to is found in the next section.</p>
</section>
<section id="creating-moving-and-deleting-objects">
<h1>Creating, Moving, and Deleting Objects<a class="headerlink" href="#creating-moving-and-deleting-objects" title="Permalink to this headline">¶</a></h1>
<p>There are two methodologies for creating and deleting objects. In both cases, you must first
bind to the parent container. When creating a new object, several attributes are required, but
other additional attributes can be specified with the <cite>optional_attributes</cite> parameter. Example 1:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ou</span> <span class="o">=</span> <span class="n">ADContainer</span><span class="o">.</span><span class="n">from_dn</span><span class="p">(</span><span class="s2">&quot;ou=workstations, dc=domain, dc=com&quot;</span><span class="p">)</span>

<span class="c1"># create a new group without any optional attributes</span>
<span class="n">new_computer</span> <span class="o">=</span> <span class="n">ADComputer</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;WS-489&quot;</span><span class="p">,</span> <span class="n">ou</span><span class="p">)</span>

<span class="c1"># create a new group with additional attributes</span>
<span class="n">new_group</span> <span class="o">=</span> <span class="n">ADGroup</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;IT-STAFF&quot;</span><span class="p">,</span> <span class="n">security_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;UNIVERSAL&#39;</span><span class="p">,</span>
                <span class="n">optional_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;all IT staff in our company&quot;</span><span class="p">})</span>
</pre></div>
</div>
<p>It is also possible to create new objects from the parent container:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ou</span> <span class="o">=</span> <span class="n">ADContainer</span><span class="o">.</span><span class="n">from_dn</span><span class="p">(</span><span class="s2">&quot;ou=workstations, dc=domain, dc=com&quot;</span><span class="p">)</span>
<span class="n">computer</span> <span class="o">=</span> <span class="n">ou</span><span class="o">.</span><span class="n">create_computer</span><span class="p">(</span><span class="s2">&quot;WS-490&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once objects are created, they can be moved:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">computer</span> <span class="o">=</span> <span class="n">ADComputer</span><span class="o">.</span><span class="n">from_cn</span><span class="p">(</span><span class="s2">&quot;WS-500&quot;</span><span class="p">)</span>
<span class="n">computer</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">ADContainer</span><span class="o">.</span><span class="n">from_dn</span><span class="p">(</span><span class="s2">&quot;ou=workstations, ou=HR, dc=company, dc=com&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>or renamed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
</pre></div>
</div>
<blockquote>
<div><p>computer = ADComputer.from_cn(“WS-500”)
computer.rename(“WS-501”)</p>
</div></blockquote>
<p>Objects can be removed by calling delete():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
</pre></div>
</div>
<blockquote>
<div><p>ADComputer.from_cn(“WS-500”).delete()</p>
</div></blockquote>
</section>
<section id="searching-active-directory">
<h1>Searching Active Directory<a class="headerlink" href="#searching-active-directory" title="Permalink to this headline">¶</a></h1>
<p>As shown above, objects can be directly connected to via CN, DN, GUID, or UPN. However,
objects can also be searched for through the ADQuery interface (and in the background, this
is how objects are actually found when you connect by CN). It is important to note that the
ADQuery interface will not provide you with pyad objects, but instead with only the attributes
for which you queried, for performance reasons. Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyad</span> <span class="kn">import</span> <span class="n">ADQuery</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ADQuery</span><span class="p">()</span>

<span class="n">q</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;distinguishedName&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">],</span>
    <span class="n">where_clause</span> <span class="o">=</span> <span class="s2">&quot;objectClass = &#39;*&#39;&quot;</span><span class="p">,</span>
    <span class="n">base_dn</span> <span class="o">=</span> <span class="s2">&quot;OU=users, DC=domain, DC=com&quot;</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">get_results</span><span class="p">():</span>
    <span class="nb">print</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;distinguishedName&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>To run unittest you will need to set the configuration to be specific to your environment.
To do this you will need to edit config.py located in the tests folder.</p>
</section>
<section id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h1>
<p>pyad is licensed under the Apache License, Version 2.0 (the “License”). You may obtain a copy
of the License at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the
License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the License for the specific language governing permissions
and limitations under the License.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python Active Directory Tools’s Documentation</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#breaking-changes-from-upstream">Breaking Changes from upstream</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#connecting-to-active-directory">Connecting to Active Directory</a></li>
<li><a class="reference internal" href="#basic-object-manipulation">Basic Object Manipulation</a></li>
<li><a class="reference internal" href="#creating-moving-and-deleting-objects">Creating, Moving, and Deleting Objects</a></li>
<li><a class="reference internal" href="#searching-active-directory">Searching Active Directory</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>

  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="pyad.html"
                          title="next chapter">Active Directory Basics</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pyad.html" title="Active Directory Basics"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Python Active Directory Tools 0.6 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python Active Directory Tools’s Documentation</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2013, Zakir Durumeric.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4fe3a2a4613f5d2d5600005d');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

  </body>
</html>